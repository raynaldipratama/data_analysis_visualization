# World map data from Natural Earth
library(rnaturalearth)
library(rnaturalearthdata)
library(ggspatial)
# Statistical function
library(MASS)
# Data visualization
library(ggplot2)
# Data manipulation
library(dplyr)
# Wind rose plot
library(openair)
spdf_world <- ne_countries(scale = "medium", returnclass = "sf")
sldf_world <- ne_coastline(scale = "medium", returnclass = "sf")
theme_set(theme_bw())
ggplot() +
geom_sf(data = spdf_world) +
geom_sf(data = sldf_world, size = 0.75) +
annotation_scale(width_hint = 0.5, location = "bl") +
annotation_north_arrow(
location = "tl",
height = unit(1.5, "cm"),
width = unit(1.5, "cm"),
pad_x = unit(0.25, "cm"),
pad_y = unit(0.25, "cm"),
style = north_arrow_fancy_orienteering
) +
annotate(
geom = "text",
x = -6,
y = 46,
label = "Bay of Biscay",
fontface = "italic",
color = "darkblue",
size = 4
) +
annotate(
geom = "point",
x = deepest_point_lon,
y = deepest_point_lat,
colour = "red",
size = 2
) +
annotate(
geom = "text",
x = deepest_point_lon,
y = 44.65,
label = "Deepest point: -5036 m",
size = 3
) +
coord_sf(xlim = c(-12, 2), ylim = c(40, 50), expand = FALSE) +
theme(
panel.grid.major = element_line(
color = gray(0.5), linetype = "dashed", size = 0.5
),
panel.background = element_rect(fill = "aliceblue")
) +
xlab("Longitude") +
ylab("Latitude") +
ggtitle("Bay of Biscay")
theme_set(theme_bw())
ggplot() +
geom_sf(data = spdf_world) +
geom_sf(data = sldf_world, size = 0.75) +
annotation_scale(width_hint = 0.5, location = "bl") +
annotation_north_arrow(
location = "tl",
height = unit(1.5, "cm"),
width = unit(1.5, "cm"),
pad_x = unit(0.25, "cm"),
pad_y = unit(0.25, "cm"),
style = north_arrow_fancy_orienteering
) +
annotate(
geom = "text",
x = -6,
y = 46,
label = "Bay of Biscay",
fontface = "italic",
color = "darkblue",
size = 4
) +
annotate(
geom = "point",
x = -3.04,
y = 43.63,
colour = "red",
size = 2
) +
annotate(
geom = "text",
x = -3,
y = 43.85,
label = "Bilbao-Vizcaya buoy",
size  = 3
) +
coord_sf(xlim = c(-12, 2), ylim = c(40, 50), expand = FALSE) +
theme(
panel.grid.major = element_line(
color = gray(0.5), linetype = "dashed", size = 0.5
),
panel.background = element_rect(fill = "aliceblue")
) +
xlab("Longitude") +
ylab("Latitude") +
ggtitle("Bay of Biscay")
buoydata <- file.path("00_data/BilbaoVizcaya.txt")
buoydata <- read.table(buoydata, header = TRUE)
buoydata <- buoydata %>%
filter(buoydata$AA > "2009") # To obtain the best records and to avoid a whole-year missing data
buoydata <- buoydata %>%
filter(buoydata$AA > "2009") # To obtain the best records and to avoid a whole-year missing data
summary(buoydata)
styler:::style_active_file()
windSpeed <- na_if(buoydata$Vv_md, "NAN")
windSpeed[is.na(windSpeed)] <- mean(windSpeed, na.rm = TRUE)
summary(windSpeed)
styler:::style_active_file()
windSpeed70 <- windSpeed * log(70 / 0.0005) / log(3 / 0.0005)
summary(windSpeed70)
windSpeed70[windSpeed70 == 0] <- 0.0001 # Weibull values must be > 0
summary(windSpeed70)
k <- coef(
fitdistr(windSpeed70, "weibull")
)[1] # Shape parameter
k
c <- coef(
fitdistr(windSpeed70, "weibull")
)[2] # Scale parameter
c
styler:::style_active_file()
qVector <- seq(0, 30, 1) # Vector of quantiles
weibulldistr <- dweibull(qVector, k, c)
histogram <- hist(windSpeed70,
qVector,
main = "Distribution of estimated wind speeds at 70 m height",
xlab = "Wind speed (m/s)",
ylim = c(0, 5000)
)
styler:::style_active_file()
plot(histogram,
freq = FALSE,
col = "lightsteelblue",
main = "Wind speeds distribution (Weibull) fit",
xlab = "Wind speed (m/s)",
ylim = c(0, 0.14)
)
lines(qVector, weibulldistr, type = "b", lwd = 5, col = "red")
F3 <- 1 - exp(-((3 / c)^k))
F25 <- 1 - exp(-((25 / c)^k))
workinghrs <- (F25 - F3) * 365.25 * 24 # Considering 365 days per year
workinghrs
Ps <- na_if(buoydata$Ps, "NAN")
Ps[is.na(Ps)] <- mean(Ps, na.rm = TRUE)
Ps <- Ps * 10^2 # Pressure unit conversion from mbar to Pa
summary(Ps)
Ta <- na_if(buoydata$Ta, "NAN")
Ta[is.na(Ta)] <- mean(Ta, na.rm = TRUE)
Ta <- Ta + 273 # Temperature unit conversion from Celcius to Kelvin
summary(Ta)
workinghrs <- (F25 - F3) * 365 * 24 # Considering 365 days per year
workinghrs
eff <- 0.4
R <- 92 / 2
A <- pi * R^2
Ps <- na_if(buoydata$Ps, "NAN")
Ps[is.na(Ps)] <- mean(Ps, na.rm = TRUE)
Ps <- Ps * 10^2 # Pressure unit conversion from mbar to Pa
summary(Ps)
Ta <- na_if(buoydata$Ta, "NAN")
Ta[is.na(Ta)] <- mean(Ta, na.rm = TRUE)
Ta <- Ta + 273 # Temperature unit conversion from Celcius to Kelvin
summary(Ta)
rho <- Ps / (287.058 * Ta) # Air density in kg/m^3
AEP0 <- eff * 0.5 * mean(rho) * A * c^3 * gamma(1 + (3 / k)) * (365 * 24)
(AEP0 <- AEP0 * 10^-9) # AEP unit conversion from Wh to GWh
CF0 <- AEP0 / (2.4 * (365.25 * 24) * 10^-3)
CF0
styler:::style_active_file()
monthlyAirDensity <- cbind(buoydata[, 1:4], rho)
boxplot(monthlyAirDensity[, 5] ~ monthlyAirDensity[, 2],
col = rainbow(12),
xlab = "Months",
ylab = "Air density"
)
title("Monthly air density")
WPD <- 0.5 * rho * (windSpeed70^3)
summary(WPD)
PC <- file.path("00_data/PC_MWT92-2.4.txt")
PC <- read.table(PC, header = TRUE) # Wind turbine power curve
density <- histogram$density # Sum of pdf must be equal to 1
ntimes <- length(density) - nrow(PC) # as a second argument in rep() to add extra elements (as many as n-times) in PC
dataPC <- c(PC[, 2], rep(0, ntimes)) # Size of dataPC equals to length of density: 30 elements
dataPC
workinghrs <- (F25 - F3) * 365 * 24 # Considering 365 days per year
workinghrs
eff <- 0.4
R <- 92 / 2
A <- pi * R^2
Ps <- na_if(buoydata$Ps, "NAN")
Ps[is.na(Ps)] <- mean(Ps, na.rm = TRUE)
Ps <- Ps * 10^2 # Pressure unit conversion from mbar to Pa
summary(Ps)
Ta <- na_if(buoydata$Ta, "NAN")
Ta[is.na(Ta)] <- mean(Ta, na.rm = TRUE)
Ta <- Ta + 273 # Temperature unit conversion from Celcius to Kelvin
summary(Ta)
rho <- Ps / (287.058 * Ta) # Air density in kg/m^3
AEP0 <- eff * 0.5 * mean(rho) * A * c^3 * gamma(1 + (3 / k)) * (365 * 24)
(AEP0 <- AEP0 * 10^-9) # AEP unit conversion from Wh to GWh
CF0 <- AEP0 / (2.4 * (365 * 24) * 10^-3)
CF0
monthlyAirDensity <- cbind(buoydata[, 1:4], rho)
boxplot(monthlyAirDensity[, 5] ~ monthlyAirDensity[, 2],
col = rainbow(12),
xlab = "Months",
ylab = "Air density"
)
title("Monthly air density")
WPD <- 0.5 * rho * (windSpeed70^3)
summary(WPD)
PC <- file.path("00_data/PC_MWT92-2.4.txt")
PC <- read.table(PC, header = TRUE) # Wind turbine power curve
density <- histogram$density # Sum of pdf must be equal to 1
ntimes <- length(density) - nrow(PC) # as a second argument in rep() to add extra elements (as many as n-times) in PC
dataPC <- c(PC[, 2], rep(0, ntimes)) # Size of dataPC equals to length of density: 30 elements
dataPC
AEP <- sum(density * dataPC) * (365 * 24) * 10^-6
AEP
CF1 <- AEP / (2400 * 10^-6 * (365.25 * 24))
CF1
CF2 <- 0.087 * mean(windSpeed70) - (2400 / 92^2)
CF2
styler:::style_active_file()
styler:::style_active_file()
